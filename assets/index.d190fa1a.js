import{g as e,a as r,c as l,r as t,m as a,_ as i,b as o,d as n,n as y}from"./vendor.f004ca6f.js";function s(e){return 1===e?0:1}function d(e,r){if("number"==typeof r)return 0===r?{field_size:e.field_size,player_size:e.player_size,ball_size:e.ball_size,right_player_control:s(e.right_player_control),left_player_control:e.left_player_control}:{field_size:e.field_size,player_size:e.player_size,ball_size:e.ball_size,right_player_control:e.right_player_control,left_player_control:s(e.left_player_control)};switch(0|r.TAG){case 0:return{field_size:r._0,player_size:e.player_size,ball_size:e.ball_size,right_player_control:e.right_player_control,left_player_control:e.left_player_control};case 1:return{field_size:e.field_size,player_size:r._0,ball_size:e.ball_size,right_player_control:e.right_player_control,left_player_control:e.left_player_control};case 2:return{field_size:e.field_size,player_size:e.player_size,ball_size:r._0,right_player_control:e.right_player_control,left_player_control:e.left_player_control}}}var p={arrowUp:!1,arrowDown:!1,keyA:!1,keyZ:!1},c=[[5,.3],[4,1.2],[3,2]];function f(r){switch(r){case 0:return e(c,0);case 1:return e(c,1);case 2:return e(c,2)}}function h(e){var t=function(e,r){var l=r.ball,t=l.y;return 10===t||t===r.fieldLimits.bottom-l.size+10?{narrow:e.narrow,broad:e.broad,wallsVertical:0===l.verticalDirection?1:0,playerVector:e.playerVector,playerVertical:e.playerVertical,predictedY:e.predictedY}:e}({narrow:void 0,broad:void 0,wallsVertical:void 0,playerVector:void 0,playerVertical:void 0,predictedY:void 0},e);if(void 0!==t.wallsVertical)return t;var a=function(e,r){var l=r.playerSize,t=r.ball,a=t.size,i=t.y,o=r.leftPlayerY,n=r.rightPlayerY,y=e.broad;return{narrow:void 0!==y?y?i+a>n&&i<n+l?0:void 0:i+a>o&&i<o+l?1:void 0:void 0,broad:e.broad,wallsVertical:e.wallsVertical,playerVector:e.playerVector,playerVertical:e.playerVertical,predictedY:e.predictedY}}(function(e,r){var l=r.ball,t=l.size,a=r.playerWidth,i=l.x+t/2,o=a/2,n=r.fieldLimits.right-a/2,y=t/2+a/2;return l.horizontalDirection?{narrow:e.narrow,broad:n-i===y?1:void 0,wallsVertical:e.wallsVertical,playerVector:e.playerVector,playerVertical:e.playerVertical,predictedY:e.predictedY}:{narrow:e.narrow,broad:i-o===y?0:void 0,wallsVertical:e.wallsVertical,playerVector:e.playerVector,playerVertical:e.playerVertical,predictedY:e.predictedY}}(t,e),e);return void 0!==a.narrow?function(e,t){for(var a=t.fieldLimits,i=a.right,o=a.bottom,n=t.ball,y=n.size,s=t.playerWidth,d=f(r(e.playerVector,n.vector)),p=d[1],c=d[0],h=n.x,m=n.y,g=l(e.narrow,0)?-1:1,P=l(e.playerVertical,1)?-1:1;h>=s&&h<i-s;)h+=c*g,(m+=p*P)<10&&(m=10,P=-P),m>o-y+10&&(m=o-y+10,P=-P);return{narrow:e.narrow,broad:e.broad,wallsVertical:e.wallsVertical,playerVector:e.playerVector,playerVertical:e.playerVertical,predictedY:m+Math.round(t.playerSize/2*Math.random()-4)*(Math.random()<.5?-1:1)}}(function(e,r){var l=(r.ball.y+r.ball.size/2-((0===r.ball.horizontalDirection?r.leftPlayerY:r.rightPlayerY)+r.playerSize/2))/r.playerSize/3*10,t=Math.round(Math.abs(l));return{narrow:e.narrow,broad:e.broad,wallsVertical:e.wallsVertical,playerVector:0!==t?1!==t?2!==t?void 0:2:1:0,playerVertical:l<0?1:l>0?0:0===l?r.ball.verticalDirection:void 0,predictedY:e.predictedY}}(a,e),e):a}function m(e,l){if("number"==typeof l){if(0!==l)return e;var t=h(e),a=t.wallsVertical;if(void 0!==a){var i=e.ball;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:{isOut:i.isOut,x:i.x,y:i.y,size:i.size,speed:i.speed,horizontalDirection:i.horizontalDirection,verticalDirection:a,vector:i.vector,predictedY:i.predictedY},fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime}}var o=e.ball,n=t.broad,y=t.playerVector;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:{isOut:void 0!==n&&void 0===y,x:o.x,y:o.y,size:o.size,speed:o.speed,horizontalDirection:r(t.narrow,e.ball.horizontalDirection),verticalDirection:r(t.playerVertical,e.ball.verticalDirection),vector:r(t.playerVector,e.ball.vector),predictedY:r(t.predictedY,e.ball.predictedY)},fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime}}switch(0|l.TAG){case 0:var s=l._0,d=e.ball;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:s.rightPlayerControl,leftPlayerControl:s.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:{isOut:d.isOut,x:d.x,y:d.y,size:s.ballSize,speed:d.speed,horizontalDirection:d.horizontalDirection,verticalDirection:d.verticalDirection,vector:d.vector,predictedY:d.predictedY},fieldLimits:{bottom:s.fieldHeight,right:s.fieldWidth},playerSize:s.playerSize,oldTime:e.oldTime};case 1:var p=l._1;return l._0?p?{rightPlayerY:e.rightPlayerY,leftPlayerY:Math.max(e.leftPlayerY-5,10),rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime}:{rightPlayerY:Math.max(e.rightPlayerY-5,10),leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime}:p?{rightPlayerY:e.rightPlayerY,leftPlayerY:Math.min(e.leftPlayerY+5,e.fieldLimits.bottom-e.playerSize+10),rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime}:{rightPlayerY:Math.min(e.rightPlayerY+5,e.fieldLimits.bottom-e.playerSize+10),leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case 2:var c=l._0;switch(l._1){case" ":var m=e.game;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:0!==m?0:1,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case"ArrowDown":var g=e.keys;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:{arrowUp:g.arrowUp,arrowDown:"keydown"===c,keyA:g.keyA,keyZ:g.keyZ},game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case"ArrowUp":var P=e.keys;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:{arrowUp:"keydown"===c,arrowDown:P.arrowDown,keyA:P.keyA,keyZ:P.keyZ},game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case"a":var u=e.keys;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:{arrowUp:u.arrowUp,arrowDown:u.arrowDown,keyA:"keydown"===c,keyZ:u.keyZ},game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case"z":var _=e.keys;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:{arrowUp:_.arrowUp,arrowDown:_.arrowDown,keyA:_.keyA,keyZ:"keydown"===c},game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};default:return e}case 3:var b=l._0,v=f(e.ball.vector),z=v[1],Y=v[0],x=e.ball.verticalDirection,C=e.ball.horizontalDirection,w=x?C?[Y,-z]:[0|-Y,-z]:C?[Y,z]:[0|-Y,z],k=e.ball;return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:{isOut:k.isOut,x:Math.max(e.playerWidth,Math.min(e.ball.x+w[0]*e.ball.speed*b,e.fieldLimits.right-e.ball.size-e.playerWidth)),y:Math.max(10,Math.min(e.ball.y+w[1]*e.ball.speed*b,e.fieldLimits.bottom-e.ball.size+10)),size:k.size,speed:k.speed,horizontalDirection:k.horizontalDirection,verticalDirection:k.verticalDirection,vector:k.vector,predictedY:k.predictedY},fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:e.oldTime};case 4:return{rightPlayerY:e.rightPlayerY,leftPlayerY:e.leftPlayerY,rightPlayerControl:e.rightPlayerControl,leftPlayerControl:e.leftPlayerControl,playerWidth:e.playerWidth,keys:e.keys,game:e.game,ball:e.ball,fieldLimits:e.fieldLimits,playerSize:e.playerSize,oldTime:l._0}}}var g=function(e){var r=e.state,l=e.send,o=function(e){var t=function(e){var l=r.ball.horizontalDirection?0===e:1===e,t=r.ball.horizontalDirection?l?[r.rightPlayerControl,r.rightPlayerY]:[r.leftPlayerControl,r.leftPlayerY]:l?[r.leftPlayerControl,r.leftPlayerY]:[r.rightPlayerControl,r.rightPlayerY],a=t[1];if(t[0])return l&&Math.abs(r.ball.predictedY-(a+r.playerSize/2))>4?r.ball.predictedY>a+r.playerSize/2?{TAG:1,_0:0,_1:e}:{TAG:1,_0:1,_1:e}:!l&&Math.abs(r.fieldLimits.bottom/2-(a+r.playerSize/2))>4?r.fieldLimits.bottom/2>a+r.playerSize/2?{TAG:1,_0:0,_1:e}:{TAG:1,_0:1,_1:e}:1;if(e){var i=r.keys.keyA,o=r.keys.keyZ;return i?o?1:{TAG:1,_0:1,_1:1}:o?{TAG:1,_0:0,_1:1}:1}var n=r.keys.arrowUp,y=r.keys.arrowDown;return n?y?1:{TAG:1,_0:1,_1:0}:y?{TAG:1,_0:0,_1:0}:1};i(l,{TAG:4,_0:e}),i(l,t(1)),i(l,t(0)),i(l,0);var a=(e-r.oldTime)/15;if(a<2)return i(l,{TAG:3,_0:a})};return t.exports.useEffect((function(){var e=r.game;return a(0!==e?void console.log(r):requestAnimationFrame(o),(function(e,r){cancelAnimationFrame(e)}))}),[r.game,r,o]),null};function P(e,r){switch(e.key){case" ":return e.preventDefault(),"keydown"===e.type?i(r,{TAG:2,_0:e.type,_1:e.key}):void 0;case"ArrowDown":case"ArrowUp":case"a":case"z":break;default:return}return e.preventDefault(),i(r,{TAG:2,_0:e.type,_1:e.key})}var u=function(e){var r,l,a,o=e.config,n=function(e){var r=Math.imul(e.field_size,22),l=e.field_size/30*440,t=Math.imul(e.player_size,10),a=(l-t)/2,i=(l-t)/2,o=r-14,n=e.ball_size;return{offsetLeft:300,offsetTop:50,fieldWidth:r,fieldHeight:l,playerSize:t,playerWidth:14,leftPlayerX:0,leftPlayerY:a,rightPlayerX:o,rightPlayerY:i,leftPlayerCenterX:7,rightPlayerCenterX:o+7,ballSize:n,ballX:(r-n)/2,ballY:(l-n)/2,leftPlayerControl:e.left_player_control,rightPlayerControl:e.right_player_control}}(o),y=n.ballSize,s=n.playerWidth,d=n.playerSize,c=n.offsetTop,f=n.offsetLeft,h=t.exports.useReducer(m,(l=(r=n).fieldHeight,{rightPlayerY:r.rightPlayerY,leftPlayerY:r.leftPlayerY,rightPlayerControl:r.rightPlayerControl,leftPlayerControl:r.leftPlayerControl,playerWidth:r.playerWidth,keys:p,game:2,ball:{isOut:!1,x:r.ballX,y:r.ballY,size:r.ballSize,speed:2.2,horizontalDirection:0,verticalDirection:0,vector:0,predictedY:l/2},fieldLimits:{bottom:l,right:r.fieldWidth},playerSize:r.playerSize,oldTime:0})),u=h[1],_=h[0];switch(t.exports.useEffect((function(){return document.addEventListener("keydown",(function(e){return P(e,u)})),document.addEventListener("keyup",(function(e){return P(e,u)})),function(e){document.removeEventListener("keyup"),document.removeEventListener("keydown")}}),[u]),t.exports.useEffect((function(){i(u,{TAG:0,_0:n}),i(u,{TAG:1,_0:1,_1:1}),i(u,{TAG:1,_0:0,_1:1}),i(u,{TAG:1,_0:1,_1:0}),i(u,{TAG:1,_0:0,_1:0}),i(u,{TAG:3,_0:0})}),[o]),_.game){case 0:a=null;break;case 1:a="Paused. Press space to resume.";break;case 2:a="Press space to start."}return t.exports.createElement(t.exports.Fragment,void 0,t.exports.createElement("div",{className:"field",style:{height:String(n.fieldHeight)+"px",left:String(f)+"px",top:String(c)+"px",width:String(n.fieldWidth)+"px"}}),t.exports.createElement("div",{className:"player",style:{height:String(d)+"px",left:String(n.leftPlayerX+f)+"px",top:String(_.leftPlayerY+c)+"px",width:String(s)+"px"}}),t.exports.createElement("div",{className:"player",style:{height:String(d)+"px",left:String(n.rightPlayerX+f)+"px",top:String(_.rightPlayerY+c)+"px",width:String(s)+"px"}}),t.exports.createElement("div",{className:_.ball.isOut?"ball-out":"ball-in",style:{height:String(y)+"px",left:String(_.ball.x+f)+"px",top:String(_.ball.y+c)+"px",width:String(y)+"px",borderRadius:String(y/2)+"px"}}),t.exports.createElement("div",{style:{left:String(f+n.fieldWidth/2-150)+"px",position:"absolute",textAlign:"center",top:String(c+n.fieldHeight+50)+"px",width:"300px"}},a),t.exports.createElement(g,{state:_,send:u}))};function _(e){var r=e.value,l=e.label,a=e.max,i=e.min,o=e.onChange;return t.exports.createElement(t.exports.Fragment,void 0,t.exports.createElement("tr",void 0,t.exports.createElement("td",{style:{paddingTop:"20px",width:"100%"}},l)),t.exports.createElement("tr",void 0,t.exports.createElement("td",void 0,t.exports.createElement("input",{max:a,min:i,type:"range",value:r,onChange:o})),t.exports.createElement("td",void 0,r)))}function b(e){var r=e.defaultChecked,l=e.label,a=e.onChange;return t.exports.createElement(t.exports.Fragment,void 0,t.exports.createElement("tr",void 0,t.exports.createElement("td",{style:{paddingTop:"20px",textAlign:"center"},span:2},l)),t.exports.createElement("tr",void 0,t.exports.createElement("td",{span:2},"Human",t.exports.createElement("label",{className:"switch"},t.exports.createElement("input",{defaultChecked:r,type:"checkbox",onChange:a}),t.exports.createElement("span",{className:"slider round"})),"NPC")))}var v=function(e){var r=e.config,l=e.setConfig;return t.exports.createElement("div",{className:"configContainer"},t.exports.createElement("fieldset",void 0,t.exports.createElement("legend",void 0,"Config"),t.exports.createElement("table",void 0,t.exports.createElement("tbody",void 0,t.exports.createElement(_,{value:String(r.field_size),label:"Field size",max:"40",min:"10",onChange:function(e){return i(l,{TAG:0,_0:0|e.target.value})}}),t.exports.createElement(_,{value:String(r.player_size),label:"Player size",max:"20",min:"6",onChange:function(e){return i(l,{TAG:1,_0:0|e.target.value})}}),t.exports.createElement(_,{value:String(r.ball_size),label:"Ball size",max:"30",min:"6",onChange:function(e){return i(l,{TAG:2,_0:0|e.target.value})}}),t.exports.createElement(b,{defaultChecked:!0,label:"Left",onChange:function(e){return i(l,1)}}),t.exports.createElement(b,{defaultChecked:!1,label:"Right",onChange:function(e){return i(l,0)}})))))};var z=function(e){var r=t.exports.useReducer(d,{field_size:25,player_size:8,ball_size:16,right_player_control:0,left_player_control:1}),l=r[0];return t.exports.createElement(t.exports.Fragment,void 0,t.exports.createElement(v,{config:l,setConfig:r[1]}),t.exports.createElement(u,{config:l}))};o.exports.render(t.exports.createElement(t.exports.StrictMode,{children:t.exports.createElement(z,{})}),n(y(document.querySelector("#root"))));
