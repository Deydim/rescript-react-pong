// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import * as Model from "./Model.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

function updateState(state, action) {
  switch (action) {
    case /* Up */0 :
        return {
                rightPlayerY: state.rightPlayerY - 5 | 0,
                keys: state.keys
              };
    case /* Down */1 :
        return {
                rightPlayerY: state.rightPlayerY + 5 | 0,
                keys: state.keys
              };
    case /* Nothing */2 :
        return state;
    case /* Start */3 :
        console.log("start");
        return state;
    
  }
}

function handleUserInput(key, isPressed) {
  switch (key) {
    case "ArrowDown" :
        Model.keys.arrowDown = isPressed;
        return ;
    case "ArrowUp" :
        Model.keys.arrowUp = isPressed;
        return ;
    default:
      return ;
  }
}

function tick(setState, oldTime, time, param) {
  var oldTime$1 = Belt_Option.getWithDefault(oldTime, 0);
  Belt_Option.getWithDefault(time, oldTime$1);
  requestAnimationFrame(function (time) {
        return tick(setState, time, oldTime$1, undefined);
      });
  var arrowUp = Model.keys.arrowUp;
  var arrowDown = Model.keys.arrowDown;
  if (arrowUp) {
    if (arrowDown || !arrowUp) {
      return Curry._1(setState, /* Nothing */2);
    } else {
      return Curry._1(setState, /* Up */0);
    }
  } else if (arrowDown) {
    return Curry._1(setState, /* Down */1);
  } else if (arrowUp) {
    return Curry._1(setState, /* Up */0);
  } else {
    return Curry._1(setState, /* Nothing */2);
  }
}

export {
  updateState ,
  handleUserInput ,
  tick ,
  
}
/* No side effect */
